#!/bin/bash

# LPæ¬„ç”Ÿæˆã‚·ã‚¹ãƒ†ãƒ å®Ÿè¡Œã‚¹ã‚¯ãƒªãƒ—ãƒˆ
# ä½¿ã„æ–¹: ./run_lp_generator.sh

echo "================================"
echo "    LPæ¬„ç”Ÿæˆã‚·ã‚¹ãƒ†ãƒ  èµ·å‹•"
echo "================================"
echo ""

# ã‚¹ã‚¯ãƒªãƒ—ãƒˆã®ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªã«ç§»å‹•
cd "$(dirname "$0")"

# Docbaseã®ä»®æƒ³ç’°å¢ƒã‚’æœ‰åŠ¹åŒ–
echo "ğŸ”§ ç’°å¢ƒæº–å‚™ä¸­..."
source ../docbase_env/bin/activate

# ãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªã®å­˜åœ¨ç¢ºèª
if [ ! -d "templates" ] || [ -z "$(ls -A templates)" ]; then
    echo "ğŸ“‹ ãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆã‚’ä½œæˆã—ã¾ã™..."
    python create_templates.py
    echo ""
fi

# ãƒ¡ã‚¤ãƒ³ã‚¹ã‚¯ãƒªãƒ—ãƒˆã‚’å®Ÿè¡Œ
echo "ğŸš€ LPæ¬„ç”Ÿæˆã‚·ã‚¹ãƒ†ãƒ ã‚’èµ·å‹•ã—ã¾ã™..."
echo ""
python lp_generator.py

# ç”Ÿæˆã•ã‚ŒãŸãƒ•ã‚¡ã‚¤ãƒ«ã®ç¢ºèª
echo ""
echo "================================"
echo "æœ€è¿‘ç”Ÿæˆã•ã‚ŒãŸLPæ¬„:"
ls -lt output/ 2>/dev/null | head -6 | tail -5

# Docbaseã‚¢ãƒƒãƒ—ãƒ­ãƒ¼ãƒ‰ã®æ¡ˆå†…
echo ""
echo "ğŸ’¡ Docbaseã«ã‚¢ãƒƒãƒ—ãƒ­ãƒ¼ãƒ‰ã™ã‚‹å ´åˆ:"
echo "   python docbase_lp_uploader.py output/[ãƒ•ã‚¡ã‚¤ãƒ«å]"
echo ""
echo "================================"